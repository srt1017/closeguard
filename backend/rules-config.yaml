rules:
  - name: "high_closing_costs"
    type: "numeric_threshold"
    pattern: "(?:closing costs?|total fees?).*?\\$([0-9,]+(?:\\.[0-9]{2})?)"
    threshold: 5000
    operator: ">"
    message: "High closing costs detected: ${value}"
    
  - name: "excessive_loan_amount"
    type: "numeric_threshold"
    pattern: "(?:loan amount|principal).*?\\$([0-9,]+(?:\\.[0-9]{2})?)"
    threshold: 500000
    operator: ">"
    message: "Loan amount exceeds threshold: ${value}"
    
  - name: "missing_title_insurance"
    type: "regex_absence"
    pattern: "title insurance"
    message: "Title insurance not found in document"
    
  - name: "missing_home_inspection"
    type: "regex_absence"
    pattern: "(?:home inspection|property inspection)"
    message: "Home inspection not mentioned in closing documents"
    
  - name: "suspicious_wire_transfer"
    type: "regex_amount"
    pattern: "wire transfer.*?\\$([0-9,]+(?:\\.[0-9]{2})?)"
    threshold: 10000
    operator: ">"
    message: "Large wire transfer detected: ${value}"
    
  - name: "high_interest_rate"
    type: "numeric_threshold"
    pattern: "(?:interest rate|apr).*?([0-9]+(?:\\.[0-9]{1,3})?)%"
    threshold: 7.0
    operator: ">"
    message: "High interest rate detected: {value}%"